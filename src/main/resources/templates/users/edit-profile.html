<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head :: head('SocialCode | Edit Profile')">
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body class="edit-profile">
<nav th:replace="fragments/navbar :: navbar"/>
<div class="container edit-profile-container text-center">
    <div class="card create-card">
        <div class="card-header">
            <h5>Edit your profile:</h5>
        </div>
        <form th:action="@{/users/{id}/edit(id=${id})}" th:method="POST" th:object="${user}">
            <div class="card-body">


<!--                        <label for="picture"></label>-->
<!--                        <input id="picture" th:field="*{picture}" />-->
                <label for="upload">Picture</label>
                <input id="picture" name="picture" value="replaceme" th:field="*{picture}" type="hidden">
                <button type="button" id="upload" name="upload">Upload an image</button>


                <div>
                    <label for="firstName">First Name</label>
                    <input id="firstName" th:field="*{firstName}"/>
                    <br>
                    <label for="lastName">Last Name</label>
                    <input id="lastName" th:field="*{lastName}"/>
                    <br>
                    <label for="username">Email</label>
                    <input id="username" th:field="*{username}"/>
                    <br>
                    <!--        <label for="password">Password</label>-->
                    <!--        <input id="password" th:field="*{password}" type="hidden"/>-->

                    <!--        <label for="passwordToConfirm">Confirm Password</label>-->
                    <!--        <input id="passwordToConfirm" th:field="*{passwordToConfirm}" type="hidden" />-->

                    <label for="city">City</label>
                    <input id="city" th:field="*{city}"/>
                </div>
                <div>

                    <!--         anchor-->
                    <label for="gitHub">GitHub URL</label>
                    <input id="gitHub" th:field="*{gitHub}"/>
                    <br>
                    <!--        anchor-->
                    <label for="linkedIn">LinkedIn URL</label>
                    <input id="linkedIn" th:field="*{linkedIn}"/>
                    <br>
                    <label for="bio">Bio</label>
                    <input id="bio" th:field="*{bio}"/>
                </div>


                <!--        add showEditControls to controller -->
                <!--        <input th:if="${showEditControls}" class="btn" type="submit"/>-->

<!--                <form th:class="alert" th:action="${'/users/' + user.id + '/delete'}" th:method="POST">-->
<!--                    &lt;!&ndash;        <button class="btn btn-danger">Delete</button>&ndash;&gt;-->
<!--                    <button class="btn btn-success" id="edit-profile-btn" type="submit">Submit</button>-->
<!--                    <button class="btn btn-success" id="delete-alert" th:class="alert" th:onclick="this.parentElement.style.display=='none'">Delete</button>-->
<!--                </form>-->
                <form th:action="${'/users/' + user.id + '/delete'}" th:method="POST">
                    <!--        <button class="btn btn-danger">Delete</button>-->
                    <button class="btn btn-success" id="edit-profile-btn" type="submit">Submit</button>
<!--                    <button class="btn btn-success" id="delete-alert" th:class="alert" th:onclick="this.parentElement.style.display=='none'">Delete</button>-->
<!--                    <button class="btn btn-success" id="delete-alert" th:class="alert" th:onclick="this.parentElement.style.display=='none'">Delete</button>-->
                </form>
            </div>
        </form>
    </div>

</div>

<script
        src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
        crossorigin="anonymous"></script>
<script src="//static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>



<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<!--<script th:inline="javascript">-->
<!--    "use strict";-->
<!--    $(document).ready(function () {-->
<!--        $("#delete-alert").click(function() {-->
<!--            confirm("Are you sure you want to leave us?");-->
<!--        })-->
<!--    })();-->
<!--</script>-->


<script th:inline="javascript">
    var apiKey = [[${apiKey}]];
    //testing it gets passed through
    // alert("Your api key is: " + apiKey);
    const client = filestack.init(apiKey);
    $("#upload").click(function () {
        client.picker(options).open()
    });

    const options = {
        fromSources: ["local_file_system","instagram","facebook"],
        transformations: {
            crop: false,
            circle: true,
            rotate: true
        },
        onUploadDone:
            function (res){
                $("#picture").val(res.filesUploaded[0].url);
                // console.log("url + " + res.filesUploaded[0].url);
            }
    }
</script>

</body>
</html>